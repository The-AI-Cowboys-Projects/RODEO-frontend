
<!doctype html>
<html lang="en">

<head>
    <title>Code coverage report for dist/assets/SandboxDashboard-CXwHBWT2.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../prettify.css" />
    <link rel="stylesheet" href="../../base.css" />
    <link rel="shortcut icon" type="image/x-icon" href="../../favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
    
<body>
<div class='wrapper'>
    <div class='pad1'>
        <h1><a href="../../index.html">All files</a> / <a href="index.html">dist/assets</a> SandboxDashboard-CXwHBWT2.js</h1>
        <div class='clearfix'>
            
            <div class='fl pad1y space-right2'>
                <span class="strong">0% </span>
                <span class="quiet">Statements</span>
                <span class='fraction'>0/22</span>
            </div>
        
            
            <div class='fl pad1y space-right2'>
                <span class="strong">0% </span>
                <span class="quiet">Branches</span>
                <span class='fraction'>0/1</span>
            </div>
        
            
            <div class='fl pad1y space-right2'>
                <span class="strong">0% </span>
                <span class="quiet">Functions</span>
                <span class='fraction'>0/1</span>
            </div>
        
            
            <div class='fl pad1y space-right2'>
                <span class="strong">0% </span>
                <span class="quiet">Lines</span>
                <span class='fraction'>0/22</span>
            </div>
        
            
        </div>
        <p class="quiet">
            Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
        </p>
        <template id="filterTemplate">
            <div class="quiet">
                Filter:
                <input type="search" id="fileSearch">
            </div>
        </template>
    </div>
    <div class='status-line low'></div>
    <pre><table class="coverage">
<tr><td class="line-count quiet"><a name='L1'></a><a href='#L1'>1</a>
<a name='L2'></a><a href='#L2'>2</a>
<a name='L3'></a><a href='#L3'>3</a>
<a name='L4'></a><a href='#L4'>4</a>
<a name='L5'></a><a href='#L5'>5</a>
<a name='L6'></a><a href='#L6'>6</a>
<a name='L7'></a><a href='#L7'>7</a>
<a name='L8'></a><a href='#L8'>8</a>
<a name='L9'></a><a href='#L9'>9</a>
<a name='L10'></a><a href='#L10'>10</a>
<a name='L11'></a><a href='#L11'>11</a>
<a name='L12'></a><a href='#L12'>12</a>
<a name='L13'></a><a href='#L13'>13</a>
<a name='L14'></a><a href='#L14'>14</a>
<a name='L15'></a><a href='#L15'>15</a>
<a name='L16'></a><a href='#L16'>16</a>
<a name='L17'></a><a href='#L17'>17</a>
<a name='L18'></a><a href='#L18'>18</a>
<a name='L19'></a><a href='#L19'>19</a>
<a name='L20'></a><a href='#L20'>20</a>
<a name='L21'></a><a href='#L21'>21</a>
<a name='L22'></a><a href='#L22'>22</a>
<a name='L23'></a><a href='#L23'>23</a></td><td class="line-coverage quiet"><span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js"><span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" ><span class="branch-0 cbranch-no" title="branch not covered" >import{b as re,j as e,u as ae}from"./query-vendor-Bgne-RFE.js";import{a as i}from"./react-vendor-z1mORbJf.js";import{u as ce}from"./index-B7LRZIR5.js";import{F as xe}from"./LinkIcon-uWwctGf8.js";import{F as A}from"./CheckCircleIcon-D2To4dgk.js";import{F as me}from"./XMarkIcon-BeZ-C2Lx.js";import{F as he}from"./CloudArrowUpIcon-CkPyAHGq.js";import{F}from"./ExclamationTriangleIcon-DaPwqFbG.js";import{F as R}from"./ArrowPathIcon-BJfNb7b8.js";import{F as V}from"./PlayIcon-BOXAdIdU.js";import{F as E}from"./CpuChipIcon-PWE1nBcs.js";import{F as L}from"./DocumentMagnifyingGlassIcon-D3u1JgbP.js";import{F as M}from"./GlobeAltIcon-DuPgHQe8.js";import{F as U}from"./ChartBarIcon-D1FLtqrj.js";import{F as pe}from"./ShieldCheckIcon-CeYePmaG.js";import{F as Y}from"./ExclamationCircleIcon-DXzWXQ1f.js";import{F as B}from"./ClockIcon-5LxbDr9y.js";import{F as O}from"./SparklesIcon-D1DJrd7L.js";import{F as ue}from"./ArrowDownTrayIcon-7_-ET380.js";import{F as I,a as le}from"./ShieldExclamationIcon-CHCu86l_.js";import{F as ne}from"./DocumentTextIcon-DHpqdMB6.js";import{R as J,B as be,C as ge,X as fe,Y as je,T as ee,j as we,n as ve,o as Ne,h as ye}from"./charts-BUYJ1XgZ.js";import{F as ke}from"./ServerIcon-CLn-Fqqk.js";import{F as se}from"./BeakerIcon-BpOU1J48.js";import{F as D}from"./XCircleIcon-B4QeeWwp.js";import{F as Ce}from"./ServerStackIcon-Du419pHJ.js";import{F as H}from"./CubeTransparentIcon-DMBj4tyY.js";import{F as _e}from"./CommandLineIcon-B6-i3YwU.js";import{F as ie}from"./FireIcon-Bf-Hk5Xz.js";import{F as Se}from"./ChevronRightIcon-_q7xNshR.js";import{F as $e}from"./SignalIcon-5duUAnom.js";function Fe({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"}))}const oe=i.forwardRef(Fe);function Ae({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"}))}const Re=i.forwardRef(Ae);function Me({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 12.75c1.148 0 2.278.08 3.383.237 1.037.146 1.866.966 1.866 2.013 0 3.728-2.35 6.75-5.25 6.75S6.75 18.728 6.75 15c0-1.046.83-1.867 1.866-2.013A24.204 24.204 0 0 1 12 12.75Zm0 0c2.883 0 5.647.508 8.207 1.44a23.91 23.91 0 0 1-1.152 6.06M12 12.75c-2.883 0-5.647.508-8.208 1.44.125 2.104.52 4.136 1.153 6.06M12 12.75a2.25 2.25 0 0 0 2.248-2.354M12 12.75a2.25 2.25 0 0 1-2.248-2.354M12 8.25c.995 0 1.971-.08 2.922-.236.403-.066.74-.358.795-.762a3.778 3.778 0 0 0-.399-2.25M12 8.25c-.995 0-1.97-.08-2.922-.236-.402-.066-.74-.358-.795-.762a3.734 3.734 0 0 1 .4-2.253M12 8.25a2.25 2.25 0 0 0-2.248 2.146M12 8.25a2.25 2.25 0 0 1 2.248 2.146M8.683 5a6.032 6.032 0 0 1-1.155-1.002c.07-.63.27-1.222.574-1.747m.581 2.749A3.75 3.75 0 0 1 15.318 5m0 0c.427-.283.815-.62 1.155-.999a4.471 4.471 0 0 0-.575-1.752M4.921 6a24.048 24.048 0 0 0-.392 3.314c1.668.546 3.416.914 5.223 1.082M19.08 6c.205 1.08.337 2.187.392 3.314a23.882 23.882 0 0 1-5.223 1.082"}))}const z=i.forwardRef(Me);function Ee({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 0 1-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0 1 15 18.257V17.25m6-12V15a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 15V5.25m18 0A2.25 2.25 0 0 0 18.75 3H5.25A2.25 2.25 0 0 0 3 5.25m18 0V12a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 12V5.25"}))}const Ie=i.forwardRef(Ee);function Le({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const te=i.forwardRef(Le);function Te({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"}))}const Pe=i.forwardRef(Te);function Oe({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"}))}const De=i.forwardRef(Oe);function ze({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5"}))}const Ve=i.forwardRef(ze);function Be({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-12.814a2.25 2.25 0 1 0 3.933-2.185 2.25 2.25 0 0 0-3.933 2.185Z"}))}const We=i.forwardRef(Be);function Ue(){const[t,s]=i.useState(typeof document&lt;"u"?document.visibilityState==="visible":!0);return i.useEffect(()=&gt;{const a=()=&gt;{s(document.visibilityState==="visible")};return document.addEventListener("visibilitychange",a),()=&gt;document.removeEventListener("visibilitychange",a)},[]),t}function He({onSubmitSuccess:t}){var m;const[s,a]=i.useState("file"),[r,l]=i.useState(!1),[d,x]=i.useState(null),[f,c]=i.useState(""),[p,g]=i.useState({fast_track:!1,vm_template:"ubuntu_analysis",timeout:300,enable_network:!1}),n=i.useRef(null),v=i.useCallback(o=&gt;{o.preventDefault(),o.stopPropagation(),o.type==="dragenter"||o.type==="dragover"?l(!0):o.type==="dragleave"&amp;&amp;l(!1)},[]),C=i.useCallback(o=&gt;{o.preventDefault(),o.stopPropagation(),l(!1),o.dataTransfer.files&amp;&amp;o.dataTransfer.files[0]&amp;&amp;u(o.dataTransfer.files[0])},[]),u=o=&gt;{if(o.size&gt;104857600){alert("File too large. Maximum size is 100MB.");return}x(o)},_=o=&gt;{o.target.files&amp;&amp;o.target.files[0]&amp;&amp;u(o.target.files[0])},w=re({mutationFn:async()=&gt;{let o=null;try{o=(await(await fetch("/auth/csrf-token")).json()).csrf_token}catch($){console.warn("Failed to fetch CSRF token:",$)}const N=new FormData;if(s==="file"&amp;&amp;d)N.append("file",d);else if(s==="url"&amp;&amp;f)N.append("url",f);else throw new Error("Please select a file or enter a URL");N.append("fast_track",p.fast_track),N.append("vm_template",p.vm_template),N.append("timeout",p.timeout),N.append("enable_network",p.enable_network);const S=await fetch("/api/sandbox/submit",{method:"POST",body:N,headers:{...o&amp;&amp;{"X-CSRF-Token":o}}});if(!S.ok){const $=await S.json().catch(()=&gt;({}));throw new Error($.detail||"Submission failed")}return S.json()},onSuccess:o=&gt;{x(null),c(""),t&amp;&amp;t(o)}}),b=()=&gt;{if(s==="file"&amp;&amp;!d){alert("Please select a file to analyze");return}if(s==="url"&amp;&amp;!f){alert("Please enter a URL to analyze");return}w.mutate()},y=o=&gt;{if(o===0)return"0 Bytes";const N=1024,S=["Bytes","KB","MB","GB"],$=Math.floor(Math.log(o)/Math.log(N));return Math.round(o/Math.pow(N,$)*100)/100+" "+S[$]};return e.jsxs("div",{className:"bg-slate-800/40 backdrop-blur-sm rounded-2xl border border-slate-700/50 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Submit for Analysis"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"One-click malware analysis with R-O-D-E-O sandbox"})]}),e.jsxs("div",{className:"flex bg-slate-900/50 rounded-lg p-1 border border-slate-700",children:[e.jsxs("button",{onClick:()=&gt;a("file"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all ${s==="file"?"bg-purple-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[e.jsx(te,{className:"w-4 h-4 inline mr-2"}),"File"]}),e.jsxs("button",{onClick:()=&gt;a("url"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all ${s==="url"?"bg-purple-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[e.jsx(xe,{className:"w-4 h-4 inline mr-2"}),"URL"]})]})]}),s==="file"&amp;&amp;e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{onDragEnter:v,onDragLeave:v,onDragOver:v,onDrop:C,onClick:()=&gt;{var o;return(o=n.current)==null?void 0:o.click()},className:`relative border-2 border-dashed rounded-xl p-8 text-center cursor-pointer transition-all ${r?"border-purple-500 bg-purple-500/10":"border-slate-600 hover:border-slate-500 bg-slate-900/30"}`,children:[e.jsx("input",{ref:n,type:"file",className:"hidden",onChange:_,accept:"*/*"}),d?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"relative",children:[e.jsx(te,{className:"w-16 h-16 text-purple-400"}),e.jsx(A,{className:"w-6 h-6 text-green-400 absolute -top-1 -right-1 bg-slate-800 rounded-full"})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-white font-semibold text-lg",children:d.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:y(d.size)})]}),e.jsxs("button",{onClick:o=&gt;{o.stopPropagation(),x(null)},className:"text-red-400 hover:text-red-300 text-sm font-medium",children:[e.jsx(me,{className:"w-4 h-4 inline mr-1"}),"Remove"]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(he,{className:"w-16 h-16 text-gray-500 mx-auto"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-semibold",children:r?"Drop file here":"Click to upload or drag and drop"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Maximum file size: 100MB"})]})]})]}),d&amp;&amp;e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-3 flex items-start space-x-3",children:[e.jsx(F,{className:"w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-blue-300 text-sm",children:"This file will be executed in an isolated sandbox environment. Ensure you have proper authorization to analyze this sample."})]})]}),s==="url"&amp;&amp;e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Enter URL to analyze"}),e.jsx("input",{type:"url",value:f,onChange:o=&gt;c(o.target.value),placeholder:"https://example.com/suspicious-page",className:"w-full bg-slate-900/50 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-purple-500 transition-colors"})]}),f&amp;&amp;e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-3 flex items-start space-x-3",children:[e.jsx(F,{className:"w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-blue-300 text-sm",children:"The URL will be visited in an isolated browser within the sandbox. All network activity will be monitored and recorded."})]})]}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 uppercase tracking-wide",children:"Analysis Options"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"VM Template"}),e.jsxs("select",{value:p.vm_template,onChange:o=&gt;g({...p,vm_template:o.target.value}),className:"w-full bg-slate-900/50 border border-slate-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:border-purple-500 transition-colors",children:[e.jsx("option",{value:"ubuntu_analysis",children:"Ubuntu Analysis"}),e.jsx("option",{value:"windows_10_analysis",children:"Windows 10 Analysis"}),e.jsx("option",{value:"web_server",children:"Web Server (PHP)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Timeout (seconds)"}),e.jsx("input",{type:"number",value:p.timeout,onChange:o=&gt;g({...p,timeout:parseInt(o.target.value)}),min:"60",max:"600",className:"w-full bg-slate-900/50 border border-slate-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:border-purple-500 transition-colors"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("label",{className:"flex items-center space-x-3 bg-slate-900/30 rounded-lg p-3 cursor-pointer hover:bg-slate-900/50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:p.fast_track,onChange:o=&gt;g({...p,fast_track:o.target.checked}),className:"w-4 h-4 text-purple-600 bg-slate-700 border-slate-600 rounded focus:ring-purple-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white text-sm font-medium",children:"Fast Track Mode"}),e.jsx("p",{className:"text-gray-400 text-xs",children:"Quick scan in &lt;25s"})]})]}),e.jsxs("label",{className:"flex items-center space-x-3 bg-slate-900/30 rounded-lg p-3 cursor-pointer hover:bg-slate-900/50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:p.enable_network,onChange:o=&gt;g({...p,enable_network:o.target.checked}),className:"w-4 h-4 text-purple-600 bg-slate-700 border-slate-600 rounded focus:ring-purple-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white text-sm font-medium",children:"Enable Network"}),e.jsx("p",{className:"text-gray-400 text-xs",children:"Allow internet access"})]})]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("button",{onClick:b,disabled:w.isPending||!d&amp;&amp;s==="file"||!f&amp;&amp;s==="url",className:`w-full py-3 px-6 rounded-lg font-semibold text-white transition-all ${w.isPending||!d&amp;&amp;s==="file"||!f&amp;&amp;s==="url"?"bg-gray-600 cursor-not-allowed":"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 shadow-lg shadow-purple-500/50"}`,children:w.isPending?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx(R,{className:"w-5 h-5 mr-2 animate-spin"}),"Submitting..."]}):e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx(V,{className:"w-5 h-5 mr-2"}),"Start Analysis"]})}),w.isError&amp;&amp;e.jsxs("div",{className:"mt-3 bg-red-500/10 border border-red-500/30 rounded-lg p-3 text-red-300 text-sm",children:[e.jsx(F,{className:"w-4 h-4 inline mr-2"}),w.error.message]}),w.isSuccess&amp;&amp;e.jsxs("div",{className:"mt-3 bg-green-500/10 border border-green-500/30 rounded-lg p-3 text-green-300 text-sm",children:[e.jsx(A,{className:"w-4 h-4 inline mr-2"}),"Analysis started! Session ID: ",(m=w.data)==null?void 0:m.session_id]})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-center space-x-6 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full"}),e.jsx("span",{className:"text-gray-400",children:p.fast_track?"Fast mode: ~25s":"Normal mode: ~40s"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full"}),e.jsx("span",{className:"text-gray-400",children:"Real-time monitoring"})]})]})]})}function Ke({sessionId:t,onComplete:s}){const[a,r]=i.useState(0),[l,d]=i.useState("initializing"),[x,f]=i.useState(!0),[c,p]=i.useState(!1),g=[{id:"initializing",name:"Initializing",description:"Setting up sandbox environment",icon:E,weight:5},{id:"vm_startup",name:"VM Startup",description:"Starting virtual machine",icon:R,weight:10},{id:"sample_transfer",name:"Sample Transfer",description:"Transferring sample to VM",icon:L,weight:5},{id:"execution",name:"Execution",description:"Running sample and monitoring",icon:z,weight:30},{id:"network_analysis",name:"Network Analysis",description:"Analyzing network connections",icon:M,weight:15},{id:"behavior_analysis",name:"Behavior Analysis",description:"Detecting malicious patterns",icon:U,weight:15},{id:"ioc_extraction",name:"IOC Extraction",description:"Extracting indicators of compromise",icon:pe,weight:10},{id:"report_generation",name:"Report Generation",description:"Generating analysis report",icon:U,weight:10}],{data:n,isLoading:v}=ae({queryKey:["session",t],queryFn:async()=&gt;{const b=await fetch(`/api/sandbox/sessions/${t}`);if(!b.ok)throw new Error("Failed to fetch session");return b.json()},refetchInterval:b=&gt;(b==null?void 0:b.status)==="completed"||(b==null?void 0:b.status)==="failed"?!1:2e3,enabled:!!t});i.useEffect(()=&gt;{if(!n)return;const b=g.findIndex(y=&gt;y.id===n.current_stage);if(b&gt;=0){d(n.current_stage);const y=g.slice(0,b).reduce((N,S)=&gt;N+S.weight,0),m=g.reduce((N,S)=&gt;N+S.weight,0),o=y/m*100;r(o)}n.status==="completed"&amp;&amp;s&amp;&amp;(r(100),s(n))},[n]);const C=b=&gt;{const y=g.findIndex(o=&gt;o.id===b),m=g.findIndex(o=&gt;o.id===l);return(n==null?void 0:n.status)==="failed"?y&lt;=m?"failed":"pending":y&lt;m?"completed":y===m?"active":"pending"},u=b=&gt;{switch(b){case"completed":return"text-green-400 bg-green-900/20 border-green-500/50";case"active":return"text-purple-400 bg-purple-900/20 border-purple-500/50 animate-pulse";case"failed":return"text-red-400 bg-red-900/20 border-red-500/50";default:return"text-gray-400 bg-slate-900/20 border-slate-700/50"}},_=(b,y)=&gt;{switch(b){case"completed":return e.jsx(A,{className:"w-5 h-5 text-green-400"});case"active":return e.jsx(R,{className:"w-5 h-5 text-purple-400 animate-spin"});case"failed":return e.jsx(Y,{className:"w-5 h-5 text-red-400"});default:return e.jsx(B,{className:"w-5 h-5 text-gray-400"})}},w=b=&gt;{if(!b)return"0s";if(b&lt;60)return`${Math.floor(b)}s`;const y=Math.floor(b/60),m=Math.floor(b%60);return`${y}m ${m}s`};return v&amp;&amp;!n?e.jsx("div",{className:"bg-slate-800/40 backdrop-blur-sm rounded-2xl border border-slate-700/50 p-6",children:e.jsxs("div",{className:"flex items-center justify-center space-x-3 text-gray-400",children:[e.jsx(R,{className:"w-5 h-5 animate-spin"}),e.jsx("span",{children:"Loading session..."})]})}):e.jsxs("div",{className:"bg-slate-800/40 backdrop-blur-sm rounded-2xl border border-slate-700/50 p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Analysis Progress"}),e.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:["Session ID: ",e.jsx("span",{className:"font-mono text-purple-400",children:t})]})]}),e.jsx("div",{className:`px-4 py-2 rounded-lg border font-semibold ${(n==null?void 0:n.status)==="completed"?"bg-green-900/20 border-green-500/50 text-green-400":(n==null?void 0:n.status)==="failed"?"bg-red-900/20 border-red-500/50 text-red-400":"bg-purple-900/20 border-purple-500/50 text-purple-400"}`,children:(n==null?void 0:n.status)==="completed"?"Completed":(n==null?void 0:n.status)==="failed"?"Failed":"Running"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Overall Progress"}),e.jsxs("span",{className:"text-sm font-semibold text-purple-400",children:[Math.floor(a),"%"]})]}),e.jsx("div",{className:"w-full bg-slate-900/50 rounded-full h-3 overflow-hidden border border-slate-700",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-purple-600 to-pink-600 transition-all duration-500 ease-out relative overflow-hidden",style:{width:`${a}%`},children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent animate-shimmer"})})})]}),n&amp;&amp;e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-slate-900/30 rounded-lg p-3 border border-slate-700/50",children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wide",children:"Elapsed Time"}),e.jsx("p",{className:"text-lg font-bold text-white mt-1",children:w(n.elapsed_time||0)})]}),e.jsxs("div",{className:"bg-slate-900/30 rounded-lg p-3 border border-slate-700/50",children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wide",children:"Estimated Remaining"}),e.jsx("p",{className:"text-lg font-bold text-white mt-1",children:n.status==="completed"?"0s":w((n.estimated_total||40)-(n.elapsed_time||0))})]}),e.jsxs("div",{className:"bg-slate-900/30 rounded-lg p-3 border border-slate-700/50",children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wide",children:"Mode"}),e.jsx("p",{className:"text-lg font-bold text-white mt-1",children:n.fast_track?"Fast (~25s)":"Normal (~40s)"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 uppercase tracking-wide mb-3",children:"Analysis Stages"}),g.map((b,y)=&gt;{const m=C(b.id);return b.icon,e.jsxs("div",{className:`flex items-center space-x-4 p-3 rounded-lg border transition-all ${u(m)}`,children:[e.jsx("div",{className:"flex-shrink-0",children:_(m)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"font-semibold text-white truncate",children:b.name}),m==="completed"&amp;&amp;e.jsx("span",{className:"text-xs text-green-400 font-medium",children:"âœ“ Done"}),m==="active"&amp;&amp;e.jsx("span",{className:"text-xs text-purple-400 font-medium animate-pulse",children:"In Progress..."})]}),e.jsx("p",{className:"text-sm text-gray-400 truncate",children:b.description})]}),e.jsx("div",{className:"flex-shrink-0",children:m==="active"&amp;&amp;e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-1.5 h-1.5 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-1.5 h-1.5 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})]},b.id)})]}),(n==null?void 0:n.sample_info)&amp;&amp;e.jsxs("div",{className:"bg-slate-900/30 rounded-lg p-4 border border-slate-700/50 space-y-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 uppercase tracking-wide",children:"Sample Info"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Name:"}),e.jsx("span",{className:"text-white ml-2 font-mono",children:n.sample_info.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Size:"}),e.jsx("span",{className:"text-white ml-2",children:n.sample_info.size})]}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-gray-400",children:"SHA256:"}),e.jsx("span",{className:"text-white ml-2 font-mono text-xs break-all",children:n.sample_info.sha256})]}),e.jsx("button",{onClick:()=&gt;navigator.clipboard.writeText(n.sample_info.sha256),className:"text-gray-400 hover:text-purple-400 transition-colors flex-shrink-0",title:"Copy hash",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]})})]})]}),(n==null?void 0:n.status)==="failed"&amp;&amp;n.error&amp;&amp;e.jsx("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Y,{className:"w-5 h-5 text-red-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-red-300",children:"Analysis Failed"}),e.jsx("p",{className:"text-sm text-red-400 mt-1",children:n.error})]})]})}),(n==null?void 0:n.status)==="running"&amp;&amp;n.stats&amp;&amp;e.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[e.jsxs("div",{className:"bg-slate-900/30 rounded-lg p-3 border border-slate-700/50 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-purple-400",children:n.stats.processes||0}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Processes"})]}),e.jsxs("div",{className:"bg-slate-900/30 rounded-lg p-3 border border-slate-700/50 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-400",children:n.stats.connections||0}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Connections"})]}),e.jsxs("div",{className:"bg-slate-900/30 rounded-lg p-3 border border-slate-700/50 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-orange-400",children:n.stats.files||0}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Files"})]}),e.jsxs("div",{className:"bg-slate-900/30 rounded-lg p-3 border border-slate-700/50 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-red-400",children:n.stats.alerts||0}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Alerts"})]})]}),(n==null?void 0:n.status)==="running"&amp;&amp;e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ie,{className:"w-5 h-5 text-green-400"}),e.jsx("h3",{className:"text-sm font-semibold text-gray-300 uppercase tracking-wide",children:"Live Sandbox View"}),e.jsxs("span",{className:"flex items-center space-x-1 text-xs text-green-400",children:[e.jsx("span",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),e.jsx("span",{children:"Live"})]}),n.viewer_url&amp;&amp;e.jsxs("span",{className:"text-xs text-gray-500",children:["Port: ",n.novnc_port||new URL(n.viewer_url).port]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=&gt;f(!x),className:"text-xs text-gray-400 hover:text-white transition-colors",children:x?"Hide":"Show"}),e.jsx("button",{onClick:()=&gt;p(!c),className:"text-gray-400 hover:text-white transition-colors",title:"Toggle fullscreen",children:e.jsx(Re,{className:"w-4 h-4"})}),n.viewer_url?e.jsx("a",{href:n.viewer_url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-purple-400 hover:text-purple-300 transition-colors",children:"Open in new tab"}):e.jsx("span",{className:"text-xs text-gray-500",children:"Waiting for VNC..."})]})]}),x&amp;&amp;n.viewer_url&amp;&amp;e.jsxs("div",{className:`relative bg-slate-900 rounded-lg border border-slate-700 overflow-hidden transition-all ${c?"h-[600px]":"h-[400px]"}`,children:[e.jsx("iframe",{src:n.viewer_url,className:"w-full h-full border-0",title:"Sandbox VNC Viewer",allow:"clipboard-read; clipboard-write"}),e.jsx("div",{className:"absolute bottom-2 right-2 bg-black/60 text-white text-xs px-2 py-1 rounded",children:"Password: rodeo123"})]}),x&amp;&amp;!n.viewer_url&amp;&amp;e.jsx("div",{className:"bg-slate-900 rounded-lg border border-slate-700 h-[400px] flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-gray-400",children:[e.jsx(R,{className:"w-8 h-8 mx-auto mb-2 animate-spin"}),e.jsx("p",{children:"Waiting for sandbox to be ready..."})]})})]})]})}const de=document.createElement("style");de.textContent=`</span></span></span>
<span class="cstat-no" title="statement not covered" >  @keyframes shimmer {</span>
<span class="cstat-no" title="statement not covered" >    0% { transform: translateX(-100%); }</span>
<span class="cstat-no" title="statement not covered" >    100% { transform: translateX(100%); }</span>
<span class="cstat-no" title="statement not covered" >  }</span>
<span class="cstat-no" title="statement not covered" >  .animate-shimmer {</span>
<span class="cstat-no" title="statement not covered" >    animation: shimmer 2s infinite;</span>
<span class="cstat-no" title="statement not covered" >  }</span>
<span class="cstat-no" title="statement not covered" >`;document.head.appendChild(de);function qe({sessionId:t,analysisResults:s}){var w,b,y;const[a,r]=i.useState([{role:"assistant",content:"ðŸ‘‹ Hi! I'm your AI analysis co-pilot. I can help you understand this malware sample. Ask me anything!",timestamp:new Date().toISOString()}]),[l,d]=i.useState(""),[x,f]=i.useState(!0),c=i.useRef(null),p=i.useRef(null);i.useEffect(()=&gt;{var m;(m=c.current)==null||m.scrollIntoView({behavior:"smooth"})},[a]);const g=re({mutationFn:async m=&gt;{const o=await fetch("/api/sandbox/copilot/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:t,question:m,analysis_results:s})});if(!o.ok)throw new Error("Query failed");return o.json()},onSuccess:m=&gt;{r(o=&gt;[...o,{role:"assistant",content:m.answer,timestamp:new Date().toISOString()}])},onError:m=&gt;{r(o=&gt;[...o,{role:"assistant",content:`Sorry, I encountered an error: ${m.message}. Please try again.`,timestamp:new Date().toISOString(),error:!0}])}}),n=m=&gt;{m.preventDefault(),l.trim()&amp;&amp;(r(o=&gt;[...o,{role:"user",content:l,timestamp:new Date().toISOString()}]),g.mutate(l),d(""),f(!1))},v=m=&gt;{var o;d(m),(o=p.current)==null||o.focus()},C=["What is the threat level?","What does this malware do?","What IOCs were found?","Is this ransomware?","What should I do next?","What MITRE techniques were used?"],u=((w=s==null?void 0:s.ai_analysis)==null?void 0:w.insights)||[],_=((b=s==null?void 0:s.ai_analysis)==null?void 0:b.triage)||{};return(y=s==null?void 0:s.ai_analysis)!=null&amp;&amp;y.recommendations,e.jsxs("div",{className:"h-full flex flex-col bg-slate-800/40 backdrop-blur-sm rounded-2xl border border-slate-700/50 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-700/50 bg-gradient-to-r from-purple-900/20 to-pink-900/20",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:"w-8 h-8 text-purple-400"}),e.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-green-400 rounded-full border-2 border-slate-800 animate-pulse"})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"AI Co-Pilot"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Augmented analysis assistant"})]})]}),_.decision&amp;&amp;e.jsx("div",{className:`px-3 py-1 rounded-lg text-sm font-semibold ${_.decision==="immediate_action"?"bg-red-900/30 text-red-400 border border-red-500/50":_.decision==="urgent_review"?"bg-orange-900/30 text-orange-400 border border-orange-500/50":_.decision==="standard_review"?"bg-yellow-900/30 text-yellow-400 border border-yellow-500/50":"bg-blue-900/30 text-blue-400 border border-blue-500/50"}`,children:_.priority})]}),u.length&gt;0&amp;&amp;e.jsxs("div",{className:"px-6 py-4 border-b border-slate-700/50 bg-slate-900/30",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(De,{className:"w-5 h-5 text-yellow-400"}),e.jsxs("h3",{className:"text-sm font-semibold text-white uppercase tracking-wide",children:["Key Insights (",u.length,")"]})]}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:u.slice(0,3).map((m,o)=&gt;e.jsx("div",{className:`p-3 rounded-lg border ${m.severity==="critical"?"bg-red-900/10 border-red-500/30":m.severity==="high"?"bg-orange-900/10 border-orange-500/30":"bg-yellow-900/10 border-yellow-500/30"}`,children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(F,{className:`w-4 h-4 flex-shrink-0 mt-0.5 ${m.severity==="critical"?"text-red-400":m.severity==="high"?"text-orange-400":"text-yellow-400"}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-white",children:m.title}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:m.description})]})]})},o))}),u.length&gt;3&amp;&amp;e.jsxs("button",{className:"text-xs text-purple-400 hover:text-purple-300 mt-2",children:["View all ",u.length," insights â†’"]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-6 py-4 space-y-4",children:[a.map((m,o)=&gt;e.jsx("div",{className:`flex ${m.role==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[80%] rounded-lg px-4 py-3 ${m.role==="user"?"bg-purple-600 text-white":m.error?"bg-red-900/20 border border-red-500/50 text-red-300":"bg-slate-900/50 border border-slate-700/50 text-white"}`,children:[m.role==="assistant"&amp;&amp;e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(O,{className:"w-4 h-4 text-purple-400"}),e.jsx("span",{className:"text-xs text-gray-400",children:"AI Co-Pilot"})]}),e.jsx("div",{className:"prose prose-sm prose-invert max-w-none",dangerouslySetInnerHTML:{__html:Ge(m.content)}}),e.jsx("div",{className:`text-xs mt-2 ${m.role==="user"?"text-purple-200":"text-gray-500"}`,children:new Date(m.timestamp).toLocaleTimeString()})]})},o)),g.isPending&amp;&amp;e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-slate-900/50 border border-slate-700/50 rounded-lg px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(R,{className:"w-4 h-4 text-purple-400 animate-spin"}),e.jsx("span",{className:"text-sm text-gray-400",children:"Analyzing..."})]})})}),e.jsx("div",{ref:c})]}),x&amp;&amp;a.length===1&amp;&amp;e.jsxs("div",{className:"px-6 py-3 border-t border-slate-700/50 bg-slate-900/30",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Suggested questions:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:C.map((m,o)=&gt;e.jsx("button",{onClick:()=&gt;v(m),className:"text-xs px-3 py-1.5 bg-slate-800/50 hover:bg-slate-800 border border-slate-700 rounded-full text-gray-300 hover:text-white transition-colors",children:m},o))})]}),e.jsxs("form",{onSubmit:n,className:"px-6 py-4 border-t border-slate-700/50 bg-slate-900/30",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{ref:p,type:"text",value:l,onChange:m=&gt;d(m.target.value),placeholder:"Ask me anything about this analysis...",disabled:g.isPending,className:"flex-1 bg-slate-800/50 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-purple-500 disabled:opacity-50 transition-colors"}),e.jsx("button",{type:"submit",disabled:!l.trim()||g.isPending,className:"px-4 py-3 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 disabled:cursor-not-allowed rounded-lg text-white font-medium transition-colors flex items-center space-x-2",children:g.isPending?e.jsx(R,{className:"w-5 h-5 animate-spin"}):e.jsx(Ve,{className:"w-5 h-5"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"ðŸ’¡ Tip: Ask about threat level, malware behavior, IOCs, or recommendations"})]})]})}function Ge(t){let s=t.replace(/\*\*(.*?)\*\*/g,'&lt;strong class="text-purple-400"&gt;$1&lt;/strong&gt;');return s=s.replace(/\n/g,"&lt;br /&gt;"),s=s.replace(/^- (.*?)$/gm,'&lt;li class="ml-4"&gt;$1&lt;/li&gt;'),s}function Xe({sessionId:t,results:s}){var x,f,c,p,g,n,v,C,u,_;const[a,r]=i.useState("overview");if(!s)return e.jsx("div",{className:"bg-slate-800/40 backdrop-blur-sm rounded-2xl border border-slate-700/50 p-8 text-center",children:e.jsx("p",{className:"text-gray-400",children:"No analysis results available"})});const l=[{id:"overview",name:"Overview",icon:U},{id:"copilot",name:"AI Co-Pilot",icon:O},{id:"behavior",name:"Behavior",icon:z},{id:"network",name:"Network",icon:M},{id:"iocs",name:"IOCs",icon:I},{id:"mitre",name:"MITRE ATT&amp;CK",icon:ne}],d=w=&gt;{switch(w==null?void 0:w.toLowerCase()){case"critical":return"text-red-400 bg-red-900/20 border-red-500/50";case"high":return"text-orange-400 bg-orange-900/20 border-orange-500/50";case"medium":return"text-yellow-400 bg-yellow-900/20 border-yellow-500/50";case"low":return"text-blue-400 bg-blue-900/20 border-blue-500/50";case"benign":case"safe":return"text-green-400 bg-green-900/20 border-green-500/50";default:return"text-yellow-400 bg-yellow-900/20 border-yellow-500/50"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-slate-800/40 backdrop-blur-sm rounded-2xl border border-slate-700/50 p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Analysis Results"}),e.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:["Session: ",e.jsx("span",{className:"font-mono text-purple-400",children:t})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{className:"px-4 py-2 bg-slate-900/50 hover:bg-slate-900/70 border border-slate-700 rounded-lg text-white text-sm font-medium transition-colors flex items-center space-x-2",children:[e.jsx(ue,{className:"w-4 h-4"}),e.jsx("span",{children:"Export"})]}),e.jsxs("button",{className:"px-4 py-2 bg-slate-900/50 hover:bg-slate-900/70 border border-slate-700 rounded-lg text-white text-sm font-medium transition-colors flex items-center space-x-2",children:[e.jsx(We,{className:"w-4 h-4"}),e.jsx("span",{children:"Share"})]})]})]}),e.jsxs("div",{className:"mt-6 flex items-center space-x-4",children:[e.jsxs("div",{className:`inline-flex items-center px-6 py-3 rounded-xl border font-bold text-lg ${d(s.threat_level||((x=s.threat_intel)==null?void 0:x.threat_level)||((f=s.classification)==null?void 0:f.threat_level))}`,children:[e.jsx(I,{className:"w-6 h-6 mr-2"}),"Threat Level: ",((g=s.threat_level||((c=s.threat_intel)==null?void 0:c.threat_level)||((p=s.classification)==null?void 0:p.threat_level))==null?void 0:g.toUpperCase())||"UNKNOWN"]}),((n=s.classification)==null?void 0:n.threat_type)&amp;&amp;e.jsx("div",{className:"px-4 py-2 bg-purple-900/20 border border-purple-500/50 rounded-lg",children:e.jsx("span",{className:"text-purple-400 font-semibold",children:s.classification.threat_type})}),((v=s.classification)==null?void 0:v.confidence)&amp;&amp;e.jsxs("div",{className:"px-4 py-2 bg-slate-900/50 border border-slate-700 rounded-lg",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Confidence: "}),e.jsxs("span",{className:"text-white font-semibold",children:[Math.round(s.classification.confidence*100),"%"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-slate-800/40 backdrop-blur-sm rounded-xl border border-slate-700/50 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Processes"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-1",children:((C=s.metadata)==null?void 0:C.process_count)||0})]}),e.jsx(E,{className:"w-10 h-10 text-purple-400"})]})}),e.jsx("div",{className:"bg-slate-800/40 backdrop-blur-sm rounded-xl border border-slate-700/50 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Network"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-1",children:((u=s.metadata)==null?void 0:u.connection_count)||0})]}),e.jsx(M,{className:"w-10 h-10 text-blue-400"})]})}),e.jsx("div",{className:"bg-slate-800/40 backdrop-blur-sm rounded-xl border border-slate-700/50 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"IOCs"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-1",children:Object.values(s.iocs||{}).flat().length||0})]}),e.jsx(I,{className:"w-10 h-10 text-orange-400"})]})}),e.jsx("div",{className:"bg-slate-800/40 backdrop-blur-sm rounded-xl border border-slate-700/50 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Patterns"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-1",children:((_=s.behavior_patterns)==null?void 0:_.length)||0})]}),e.jsx(z,{className:"w-10 h-10 text-red-400"})]})})]}),e.jsxs("div",{className:"bg-slate-800/40 backdrop-blur-sm rounded-2xl border border-slate-700/50 overflow-hidden",children:[e.jsx("div",{className:"flex border-b border-slate-700",children:l.map(w=&gt;{const b=w.icon;return e.jsxs("button",{onClick:()=&gt;r(w.id),className:`flex-1 px-6 py-4 text-sm font-medium transition-all ${a===w.id?"bg-purple-600/20 text-purple-400 border-b-2 border-purple-500":"text-gray-400 hover:text-white hover:bg-slate-900/30"}`,children:[e.jsx(b,{className:"w-5 h-5 inline mr-2"}),w.name]},w.id)})}),e.jsxs("div",{className:a==="copilot"?"h-[600px]":"p-6",children:[a==="overview"&amp;&amp;e.jsx(Ze,{results:s}),a==="copilot"&amp;&amp;e.jsx(qe,{sessionId:t,analysisResults:s}),a==="behavior"&amp;&amp;e.jsx(Qe,{results:s}),a==="network"&amp;&amp;e.jsx(Ye,{results:s}),a==="iocs"&amp;&amp;e.jsx(Je,{results:s}),a==="mitre"&amp;&amp;e.jsx(es,{results:s})]})]})]})}function Ze({results:t}){var d,x,f;const s=Object.entries(t.iocs||{}).map(([c,p])=&gt;({name:c.replace(/_/g," ").toUpperCase(),count:Array.isArray(p)?p.length:0})).filter(c=&gt;c.count&gt;0),a=(t.behavior_patterns||[]).reduce((c,p)=&gt;{const g=p.severity||"unknown";return c[g]=(c[g]||0)+1,c},{}),r=Object.entries(a).map(([c,p])=&gt;({name:c.charAt(0).toUpperCase()+c.slice(1),value:p})),l=["#ef4444","#f59e0b","#eab308","#22c55e"];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-slate-900/30 rounded-lg p-4 border border-slate-700/50",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Analysis Summary"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{className:"text-gray-300",children:[e.jsx("span",{className:"text-gray-400",children:"Threat Type:"})," ",e.jsx("span",{className:"font-semibold text-purple-400",children:((d=t.classification)==null?void 0:d.threat_type)||"Unknown"})]}),e.jsxs("p",{className:"text-gray-300",children:[e.jsx("span",{className:"text-gray-400",children:"Classification:"})," ",e.jsx("span",{className:"font-semibold",children:((x=t.classification)==null?void 0:x.family)||"N/A"})]}),e.jsxs("p",{className:"text-gray-300",children:[e.jsx("span",{className:"text-gray-400",children:"Severity Score:"})," ",e.jsxs("span",{className:"font-semibold text-orange-400",children:[((f=t.classification)==null?void 0:f.severity)||0,"/10"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[s.length&gt;0&amp;&amp;e.jsxs("div",{className:"bg-slate-900/30 rounded-lg p-4 border border-slate-700/50",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 uppercase tracking-wide mb-4",children:"IOC Distribution"}),e.jsx(J,{width:"100%",height:200,children:e.jsxs(be,{data:s,children:[e.jsx(ge,{strokeDasharray:"3 3",stroke:"#334155"}),e.jsx(fe,{dataKey:"name",stroke:"#94a3b8",tick:{fontSize:12}}),e.jsx(je,{stroke:"#94a3b8",tick:{fontSize:12}}),e.jsx(ee,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #475569",borderRadius:"8px"},labelStyle:{color:"#e2e8f0"}}),e.jsx(we,{dataKey:"count",fill:"#800080",radius:[4,4,0,0]})]})})]}),r.length&gt;0&amp;&amp;e.jsxs("div",{className:"bg-slate-900/30 rounded-lg p-4 border border-slate-700/50",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 uppercase tracking-wide mb-4",children:"Pattern Severity"}),e.jsx(J,{width:"100%",height:200,children:e.jsxs(ve,{children:[e.jsx(Ne,{data:r,cx:"50%",cy:"50%",labelLine:!1,label:({name:c,percent:p})=&gt;`${c} ${(p*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:r.map((c,p)=&gt;e.jsx(ye,{fill:l[p%l.length]},`cell-${p}`))}),e.jsx(ee,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #475569",borderRadius:"8px"}})]})})]})]}),t.yara_rule&amp;&amp;e.jsxs("div",{className:"bg-slate-900/30 rounded-lg p-4 border border-slate-700/50",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 uppercase tracking-wide mb-3",children:"Generated YARA Rule"}),e.jsxs("pre",{className:"bg-slate-950/50 rounded-lg p-4 text-sm text-green-400 font-mono overflow-x-auto border border-slate-700",children:[t.yara_rule.substring(0,500),t.yara_rule.length&gt;500&amp;&amp;"..."]})]})]})}function Qe({results:t}){const s=t.behavior_patterns||[],a=l=&gt;{switch(l==null?void 0:l.toLowerCase()){case"critical":return e.jsx(F,{className:"w-5 h-5 text-red-400"});case"high":return e.jsx(F,{className:"w-5 h-5 text-orange-400"});case"medium":return e.jsx(F,{className:"w-5 h-5 text-yellow-400"});default:return e.jsx(A,{className:"w-5 h-5 text-blue-400"})}},r=l=&gt;{switch(l==null?void 0:l.toLowerCase()){case"critical":return"border-red-500/50 bg-red-900/10";case"high":return"border-orange-500/50 bg-orange-900/10";case"medium":return"border-yellow-500/50 bg-yellow-900/10";default:return"border-blue-500/50 bg-blue-900/10"}};return e.jsx("div",{className:"space-y-4",children:s.length===0?e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No behavior patterns detected"}):s.map((l,d)=&gt;{var x;return e.jsx("div",{className:`border rounded-lg p-4 ${r(l.severity)}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:a(l.severity)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("h4",{className:"font-semibold text-white",children:l.name}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${l.severity==="critical"?"bg-red-500/20 text-red-400":l.severity==="high"?"bg-orange-500/20 text-orange-400":l.severity==="medium"?"bg-yellow-500/20 text-yellow-400":"bg-blue-500/20 text-blue-400"}`,children:(x=l.severity)==null?void 0:x.toUpperCase()})]}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:l.description}),l.confidence&amp;&amp;e.jsxs("p",{className:"text-gray-500 text-xs mt-2",children:["Confidence: ",Math.round(l.confidence*100),"%"]})]})]})},d)})})}function Ye({results:t}){var l,d;const s=t.network_connections||[],a=((l=t.iocs)==null?void 0:l.ip_addresses)||[],r=((d=t.iocs)==null?void 0:d.domains)||[];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-slate-900/30 rounded-lg p-4 border border-slate-700/50",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Total Connections"}),e.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:s.length})]}),e.jsxs("div",{className:"bg-slate-900/30 rounded-lg p-4 border border-slate-700/50",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Unique IPs"}),e.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:a.length})]}),e.jsxs("div",{className:"bg-slate-900/30 rounded-lg p-4 border border-slate-700/50",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Domains"}),e.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:r.length})]})]}),s.length&gt;0&amp;&amp;e.jsxs("div",{className:"bg-slate-900/30 rounded-lg border border-slate-700/50 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-slate-700",children:e.jsx("h3",{className:"text-sm font-semibold text-gray-300 uppercase tracking-wide",children:"Network Connections"})}),e.jsx("div",{className:"divide-y divide-slate-700 max-h-96 overflow-y-auto",children:s.slice(0,20).map((x,f)=&gt;e.jsx("div",{className:"px-4 py-3 hover:bg-slate-900/50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-white font-mono text-sm",children:x.remote_address}),e.jsxs("p",{className:"text-gray-400 text-xs mt-1",children:[x.protocol," â€¢ ",x.state]})]}),e.jsxs("span",{className:"text-xs text-gray-500",children:["PID: ",x.pid]})]})},f))})]})]})}function Je({results:t}){const s=t.iocs||{},a=[{key:"ip_addresses",name:"IP Addresses",icon:ke},{key:"domains",name:"Domains",icon:M},{key:"file_hashes",name:"File Hashes",icon:ne},{key:"file_paths",name:"File Paths",icon:Pe}];return e.jsxs("div",{className:"space-y-4",children:[a.map(r=&gt;{const l=s[r.key]||[],d=r.icon;return l.length===0?null:e.jsxs("div",{className:"bg-slate-900/30 rounded-lg border border-slate-700/50 overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-slate-700 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(d,{className:"w-5 h-5 text-purple-400"}),e.jsx("h3",{className:"text-sm font-semibold text-gray-300 uppercase tracking-wide",children:r.name})]}),e.jsxs("span",{className:"text-xs text-gray-500 bg-slate-900/50 px-2 py-1 rounded",children:[l.length," found"]})]}),e.jsx("div",{className:"divide-y divide-slate-700 max-h-60 overflow-y-auto",children:l.map((x,f)=&gt;e.jsx("div",{className:"px-4 py-2 hover:bg-slate-900/50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("p",{className:"text-white font-mono text-sm break-all flex-1",children:x}),e.jsx("button",{onClick:()=&gt;navigator.clipboard.writeText(x),className:"text-gray-500 hover:text-purple-400 transition-colors flex-shrink-0",title:"Copy",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]})},f))})]},r.key)}),Object.values(s).every(r=&gt;r.length===0)&amp;&amp;e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No IOCs extracted"})]})}function es({results:t}){const s=t.mitre_techniques||[],a=s.reduce((l,d)=&gt;{const x=d.tactic||"Unknown";return l[x]||(l[x]=[]),l[x].push(d),l},{}),r={"Initial Access":"border-red-500/50 bg-red-900/10",Execution:"border-orange-500/50 bg-orange-900/10",Persistence:"border-yellow-500/50 bg-yellow-900/10","Privilege Escalation":"border-green-500/50 bg-green-900/10","Defense Evasion":"border-blue-500/50 bg-blue-900/10","Credential Access":"border-purple-500/50 bg-purple-900/10",Discovery:"border-pink-500/50 bg-pink-900/10","Lateral Movement":"border-indigo-500/50 bg-indigo-900/10",Collection:"border-cyan-500/50 bg-cyan-900/10","Command and Control":"border-teal-500/50 bg-teal-900/10",Exfiltration:"border-lime-500/50 bg-lime-900/10",Impact:"border-rose-500/50 bg-rose-900/10"};return e.jsx("div",{className:"space-y-4",children:s.length===0?e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No MITRE ATT&amp;CK techniques mapped"}):Object.entries(a).map(([l,d])=&gt;e.jsxs("div",{className:`border rounded-lg p-4 ${r[l]||"border-slate-700 bg-slate-900/10"}`,children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:l}),e.jsx("div",{className:"space-y-2",children:d.map((x,f)=&gt;e.jsx("div",{className:"bg-slate-950/30 rounded p-3 border border-slate-700/50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:x.name}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:x.description})]}),e.jsx("span",{className:"text-xs text-gray-500 bg-slate-900/50 px-2 py-1 rounded",children:x.technique_id})]})},f))})]},l))})}function ss(){const t=i.useRef(null);return i.useEffect(()=&gt;{const s=t.current;if(!s)return;const a=s.getContext("2d"),r=[],l=50,d=()=&gt;{s.width=s.offsetWidth,s.height=s.offsetHeight};d(),window.addEventListener("resize",d);for(let c=0;c&lt;l;c++)r.push({x:Math.random()*s.width,y:Math.random()*s.height,vx:(Math.random()-.5)*.5,vy:(Math.random()-.5)*.5,size:Math.random()*2+1,opacity:Math.random()*.5+.2});const x=()=&gt;{a.clearRect(0,0,s.width,s.height),r.forEach((c,p)=&gt;{c.x+=c.vx,c.y+=c.vy,(c.x&lt;0||c.x&gt;s.width)&amp;&amp;(c.vx*=-1),(c.y&lt;0||c.y&gt;s.height)&amp;&amp;(c.vy*=-1),a.beginPath(),a.arc(c.x,c.y,c.size,0,Math.PI*2),a.fillStyle=`rgba(128, 0, 128, ${c.opacity})`,a.fill(),r.forEach((g,n)=&gt;{if(p===n)return;const v=c.x-g.x,C=c.y-g.y,u=Math.sqrt(v*v+C*C);u&lt;100&amp;&amp;(a.beginPath(),a.moveTo(c.x,c.y),a.lineTo(g.x,g.y),a.strokeStyle=`rgba(128, 0, 128, ${.1*(1-u/100)})`,a.stroke())})}),requestAnimationFrame(x)},f=requestAnimationFrame(x);return()=&gt;{window.removeEventListener("resize",d),cancelAnimationFrame(f)}},[]),e.jsx("canvas",{ref:t,className:"absolute inset-0 w-full h-full pointer-events-none opacity-40"})}function ts({isActive:t,threatLevel:s}){const a=()=&gt;{switch(s){case"critical":return"#ef4444";case"high":return"#f97316";case"medium":return"#eab308";default:return"#22c55e"}};return e.jsx("div",{className:"relative w-full h-48 perspective-1000",children:e.jsxs("div",{className:`absolute inset-4 border-2 border-dashed rounded-xl transition-all duration-500 ${t?"border-brand-purple animate-pulse-slow":"border-slate-600"}`,children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:`relative w-24 h-24 transform-style-3d ${t?"animate-spin-slow":""}`,style:{animation:t?"float 3s ease-in-out infinite":"none"},children:[e.jsx("div",{className:"absolute inset-0 border-2 border-brand-purple/50 bg-brand-purple/10 rounded-lg transform rotate-y-0"}),e.jsx("div",{className:"absolute inset-2 border border-brand-purple/30 rounded"}),e.jsx("div",{className:"absolute inset-4 border border-brand-purple/20 rounded"}),t&amp;&amp;e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 overflow-hidden rounded-lg",children:e.jsx("div",{className:"absolute w-full h-1 bg-gradient-to-r from-transparent via-brand-purple to-transparent animate-scan"})}),e.jsx("div",{className:"absolute -inset-2 border border-brand-purple/20 rounded-xl animate-pulse"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:t?e.jsx(E,{className:"w-10 h-10 text-brand-purple animate-pulse"}):e.jsx(H,{className:"w-10 h-10 text-slate-500"})})]})}),e.jsxs("div",{className:"absolute top-2 left-2 flex items-center space-x-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${t?"bg-green-400 animate-pulse":"bg-slate-600"}`}),e.jsx("span",{className:"text-xs text-white/60",children:t?"ISOLATED":"STANDBY"})]}),s&amp;&amp;e.jsx("div",{className:"absolute top-2 right-2 px-2 py-1 rounded text-xs font-bold",style:{backgroundColor:`${a()}20`,color:a()},children:s.toUpperCase()}),e.jsx("div",{className:"absolute top-0 left-0 w-4 h-4 border-l-2 border-t-2 border-brand-purple/50 rounded-tl"}),e.jsx("div",{className:"absolute top-0 right-0 w-4 h-4 border-r-2 border-t-2 border-brand-purple/50 rounded-tr"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-4 h-4 border-l-2 border-b-2 border-brand-purple/50 rounded-bl"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-4 h-4 border-r-2 border-b-2 border-brand-purple/50 rounded-br"})]})})}function P({icon:t,label:s,value:a,color:r,trend:l,onClick:d}){const[x,f]=i.useState(!1);return e.jsxs("button",{onClick:d,onMouseEnter:()=&gt;f(!0),onMouseLeave:()=&gt;f(!1),className:`relative overflow-hidden bg-slate-900/30 rounded-xl p-4 border-2 border-slate-700/50</span>
<span class="cstat-no" title="statement not covered" >        transition-all duration-300 hover:border-${r}-500/50 hover:bg-slate-800/50</span>
<span class="cstat-no" title="statement not covered" >        hover:transform hover:scale-105 hover:shadow-lg group text-left w-full`,style:{"--glow-color":r==="brand-purple"?"#800080":void 0},children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br from-${r}-500/0 to-${r}-500/10</span>
<span class="cstat-no" title="statement not covered" >        opacity-0 group-hover:opacity-100 transition-opacity duration-300`}),e.jsxs("div",{className:"relative flex items-center space-x-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center transition-all duration-300</span>
<span class="cstat-no" title="statement not covered" >          ${x?`bg-${r}-500/30 scale-110`:`bg-${r}-500/20`}`,children:e.jsx(t,{className:`w-6 h-6 text-${r}-400 transition-transform duration-300</span>
<span class="cstat-no" title="statement not covered" >            ${x?"scale-110":""}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white/70 font-semibold",children:s}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:a}),l&amp;&amp;e.jsxs("span",{className:`text-xs px-1.5 py-0.5 rounded ${l&gt;0?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:[l&gt;0?"+":"",l,"%"]})]})]})]}),e.jsx("div",{className:`absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent</span>
<span class="cstat-no" title="statement not covered" >        transform -translate-x-full group-hover:translate-x-full transition-transform duration-1000`})]})}function rs({sessions:t}){const s=[{type:"threat",message:"Trojan.GenericKD detected in sample",time:"2s ago",icon:I},{type:"behavior",message:"Malware attempting process injection",time:"5s ago",icon:z},{type:"threat",message:"Ransomware encryption routine identified",time:"8s ago",icon:ie},{type:"network",message:"C2 beacon to malicious IP blocked",time:"12s ago",icon:M},{type:"behavior",message:"Suspicious registry persistence detected",time:"18s ago",icon:F},{type:"threat",message:"Packed PE with UPX obfuscation unpacked",time:"25s ago",icon:L}];return e.jsxs("div",{className:"bg-slate-900/50 rounded-xl border border-slate-700/50 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($e,{className:"w-4 h-4 text-red-400 animate-pulse"}),e.jsx("span",{className:"text-sm font-semibold text-white",children:"Malware Activity"})]}),e.jsx("span",{className:"text-xs text-red-400/70",children:"Live threats"})]}),e.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:s.map((a,r)=&gt;e.jsxs("div",{className:"flex items-center space-x-2 text-xs p-2 rounded bg-slate-800/50 animate-fadeIn",style:{animationDelay:`${r*100}ms`},children:[e.jsx(a.icon,{className:`w-4 h-4 flex-shrink-0 ${a.type==="threat"?"text-red-400":a.type==="network"?"text-blue-400":a.type==="behavior"?"text-yellow-400":"text-green-400"}`}),e.jsx("span",{className:"text-white/80 flex-1",children:a.message}),e.jsx("span",{className:"text-white/40",children:a.time})]},r))})]})}function as({isActive:t}){const[s,a]=i.useState([{text:"$ rodeo-sandbox --init",type:"command"},{text:"[*] Initializing isolated environment...",type:"info"},{text:"[+] Container ready",type:"success"}]);return i.useEffect(()=&gt;{if(!t)return;const r=[{text:"[*] Loading sample into sandbox...",type:"info"},{text:"[*] Starting behavioral analysis...",type:"info"},{text:"[+] Process hooks installed",type:"success"},{text:"[*] Monitoring network activity...",type:"info"},{text:"[!] Suspicious API call detected: VirtualAlloc",type:"warning"},{text:"[!] Registry modification detected",type:"warning"},{text:"[+] Memory dump captured",type:"success"}];let l=0;const d=setInterval(()=&gt;{l&lt;r.length&amp;&amp;(a(x=&gt;[...x.slice(-8),r[l]]),l++)},1500);return()=&gt;clearInterval(d)},[t]),e.jsxs("div",{className:"bg-black/80 rounded-xl border border-slate-700 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center space-x-2 px-4 py-2 bg-slate-800/50 border-b border-slate-700",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),e.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),e.jsx("span",{className:"ml-2 text-xs text-white/50 font-mono",children:"sandbox-terminal"})]}),e.jsxs("div",{className:"p-4 font-mono text-sm h-48 overflow-y-auto",children:[s.map((r,l)=&gt;e.jsx("div",{className:`animate-fadeIn ${r.type==="command"?"text-cyan-400":r.type==="success"?"text-green-400":r.type==="warning"?"text-yellow-400":r.type==="error"?"text-red-400":"text-white/70"}`,children:r.text},l)),e.jsxs("div",{className:"flex items-center text-cyan-400",children:[e.jsx("span",{children:"$ "}),e.jsx("span",{className:"w-2 h-4 bg-cyan-400 animate-pulse ml-1"})]})]})]})}function ls({level:t}){const a=(()=&gt;{switch(t){case"critical":return{percent:100,color:"#ef4444",label:"CRITICAL"};case"high":return{percent:75,color:"#f97316",label:"HIGH"};case"medium":return{percent:50,color:"#eab308",label:"MEDIUM"};case"low":return{percent:25,color:"#22c55e",label:"LOW"};default:return{percent:0,color:"#64748b",label:"UNKNOWN"}}})(),r=2*Math.PI*45,l=r-a.percent/100*r;return e.jsxs("div",{className:"relative w-32 h-32 mx-auto",children:[e.jsxs("svg",{className:"w-full h-full transform -rotate-90",children:[e.jsx("circle",{cx:"64",cy:"64",r:"45",stroke:"#1e293b",strokeWidth:"8",fill:"none"}),e.jsx("circle",{cx:"64",cy:"64",r:"45",stroke:a.color,strokeWidth:"8",fill:"none",strokeLinecap:"round",strokeDasharray:r,strokeDashoffset:l,className:"transition-all duration-1000"})]}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[e.jsxs("span",{className:"text-2xl font-bold",style:{color:a.color},children:[a.percent,"%"]}),e.jsx("span",{className:"text-xs text-white/60 font-semibold",children:a.label})]})]})}function ns({session:t,isActive:s,onClick:a}){const l=(x=&gt;{switch(x){case"completed":return{bg:"bg-green-500/10",border:"border-green-500/30",icon:A,iconColor:"text-green-400",glow:"shadow-green-500/20"};case"running":return{bg:"bg-blue-500/10",border:"border-blue-500/30",icon:V,iconColor:"text-blue-400",glow:"shadow-blue-500/20"};case"failed":return{bg:"bg-red-500/10",border:"border-red-500/30",icon:D,iconColor:"text-red-400",glow:"shadow-red-500/20"};default:return{bg:"bg-slate-500/10",border:"border-slate-500/30",icon:B,iconColor:"text-slate-400",glow:""}}})(t.status),d=l.icon;return e.jsxs("button",{onClick:a,className:`w-full text-left p-4 rounded-xl border-2 transition-all duration-300</span>
<span class="cstat-no" title="statement not covered" >        hover:transform hover:scale-[1.02] group relative overflow-hidden</span>
<span class="cstat-no" title="statement not covered" >        ${s?"bg-brand-purple/20 border-brand-purple/50 shadow-lg shadow-brand-purple/20":`${l.bg} ${l.border} hover:${l.glow} hover:shadow-lg`}`,children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-r from-brand-purple/0 via-brand-purple/5 to-brand-purple/0</span>
<span class="cstat-no" title="statement not covered" >        opacity-0 group-hover:opacity-100 transition-opacity`}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${l.bg}</span>
<span class="cstat-no" title="statement not covered" >              group-hover:scale-110 transition-transform`,children:e.jsx(d,{className:`w-5 h-5 ${l.iconColor} ${t.status==="running"?"animate-pulse":""}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-white font-semibold truncate text-sm",children:t.sample_name||t.session_id.slice(0,12)}),e.jsx("p",{className:"text-xs text-white/50 mt-0.5",children:new Date(t.created_at).toLocaleString()})]})]}),e.jsx(Se,{className:`w-5 h-5 text-white/30 group-hover:text-white/60</span>
<span class="cstat-no" title="statement not covered" >            group-hover:translate-x-1 transition-all`})]}),t.threat_level&amp;&amp;e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsx("span",{className:`text-xs px-2 py-1 rounded font-bold ${t.threat_level==="critical"?"bg-red-500/20 text-red-400":t.threat_level==="high"?"bg-orange-500/20 text-orange-400":t.threat_level==="medium"?"bg-yellow-500/20 text-yellow-400":"bg-green-500/20 text-green-400"}`,children:t.threat_level.toUpperCase()}),t.status==="running"&amp;&amp;e.jsxs("div",{className:"flex items-center space-x-1 text-xs text-blue-400",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full animate-pulse"}),e.jsx("span",{children:"Analyzing..."})]})]})]})]})}function is({session:t,onClose:s,onViewResults:a}){const[r,l]=i.useState(null),[d,x]=i.useState(!0);if(i.useEffect(()=&gt;{if(!t)return;(async()=&gt;{x(!0);try{const v=localStorage.getItem("rodeo_token"),C={"Content-Type":"application/json"};v&amp;&amp;(C.Authorization=`Bearer ${v}`);const u=await fetch(`/api/sandbox/sessions/${t.session_id}`,{headers:C});if(u.ok){const _=await u.json();l(_)}}catch(v){console.error("Failed to fetch session details:",v)}finally{x(!1)}})()},[t]),!t)return null;const f=n=&gt;{switch(n){case"completed":return{bg:"bg-green-500/20",text:"text-green-400",label:"Completed"};case"running":return{bg:"bg-blue-500/20",text:"text-blue-400",label:"Running"};case"failed":return{bg:"bg-red-500/20",text:"text-red-400",label:"Failed"};case"pending":return{bg:"bg-yellow-500/20",text:"text-yellow-400",label:"Pending"};default:return{bg:"bg-gray-500/20",text:"text-gray-400",label:n}}},c=n=&gt;{switch(n){case"critical":return{bg:"bg-red-500/20",text:"text-red-400",border:"border-red-500/50"};case"high":return{bg:"bg-orange-500/20",text:"text-orange-400",border:"border-orange-500/50"};case"medium":return{bg:"bg-yellow-500/20",text:"text-yellow-400",border:"border-yellow-500/50"};default:return{bg:"bg-green-500/20",text:"text-green-400",border:"border-green-500/50"}}},p=f(t.status),g=t.threat_level?c(t.threat_level):null;return e.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",onClick:s,children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),e.jsx("div",{className:"absolute inset-4 md:inset-10 lg:inset-20 flex items-center justify-center",children:e.jsxs("div",{className:"w-full max-w-2xl max-h-full overflow-hidden bg-gradient-to-b from-slate-800 to-slate-900 rounded-2xl border-2 border-slate-700 shadow-2xl",onClick:n=&gt;n.stopPropagation(),children:[e.jsx("div",{className:"p-6 border-b border-slate-700",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${p.bg}`,children:t.status==="completed"?e.jsx(A,{className:`w-8 h-8 ${p.text}`}):t.status==="running"?e.jsx(V,{className:`w-8 h-8 ${p.text} animate-pulse`}):t.status==="failed"?e.jsx(D,{className:`w-8 h-8 ${p.text}`}):e.jsx(B,{className:`w-8 h-8 ${p.text}`})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:t.sample_name||"Unknown Sample"}),e.jsx("p",{className:"text-sm text-white/50 font-mono",children:t.session_id})]})]}),e.jsx("button",{onClick:s,className:"p-2 rounded-lg hover:bg-slate-700 text-white/60 hover:text-white transition-colors",children:e.jsx(D,{className:"w-6 h-6"})})]})}),e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[60vh] space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:`p-4 rounded-xl ${p.bg} border border-slate-600/50`,children:[e.jsx("p",{className:"text-xs text-white/50 uppercase tracking-wider mb-1",children:"Status"}),e.jsx("p",{className:`text-lg font-bold ${p.text}`,children:p.label})]}),g&amp;&amp;e.jsxs("div",{className:`p-4 rounded-xl ${g.bg} border ${g.border}`,children:[e.jsx("p",{className:"text-xs text-white/50 uppercase tracking-wider mb-1",children:"Threat Level"}),e.jsx("p",{className:`text-lg font-bold ${g.text} uppercase`,children:t.threat_level})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-slate-700/30 border border-slate-600/50",children:[e.jsx("p",{className:"text-xs text-white/50 uppercase tracking-wider mb-1",children:"Created"}),e.jsx("p",{className:"text-white font-medium",children:new Date(t.created_at).toLocaleString()})]}),t.completed_at&amp;&amp;e.jsxs("div",{className:"p-4 rounded-xl bg-slate-700/30 border border-slate-600/50",children:[e.jsx("p",{className:"text-xs text-white/50 uppercase tracking-wider mb-1",children:"Completed"}),e.jsx("p",{className:"text-white font-medium",children:new Date(t.completed_at).toLocaleString()})]})]}),d?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"w-8 h-8 border-4 border-brand-purple/30 border-t-brand-purple rounded-full animate-spin"})}):r&amp;&amp;e.jsxs(e.Fragment,{children:[(r.file_type||r.file_size||r.sha256)&amp;&amp;e.jsxs("div",{className:"p-4 rounded-xl bg-slate-700/30 border border-slate-600/50",children:[e.jsx("p",{className:"text-xs text-white/50 uppercase tracking-wider mb-3",children:"Sample Information"}),e.jsxs("div",{className:"space-y-2",children:[r.file_type&amp;&amp;e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-white/60",children:"File Type"}),e.jsx("span",{className:"text-white font-mono",children:r.file_type})]}),r.file_size&amp;&amp;e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-white/60",children:"File Size"}),e.jsxs("span",{className:"text-white font-mono",children:[(r.file_size/1024).toFixed(2)," KB"]})]}),r.sha256&amp;&amp;e.jsxs("div",{children:[e.jsx("span",{className:"text-white/60 block mb-1",children:"SHA-256"}),e.jsx("span",{className:"text-white font-mono text-xs break-all",children:r.sha256})]})]})]}),r.summary&amp;&amp;e.jsxs("div",{className:"p-4 rounded-xl bg-slate-700/30 border border-slate-600/50",children:[e.jsx("p",{className:"text-xs text-white/50 uppercase tracking-wider mb-2",children:"Analysis Summary"}),e.jsx("p",{className:"text-white/80",children:r.summary})]}),r.detections&amp;&amp;e.jsxs("div",{className:"p-4 rounded-xl bg-slate-700/30 border border-slate-600/50",children:[e.jsx("p",{className:"text-xs text-white/50 uppercase tracking-wider mb-3",children:"Detection Results"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-red-400",children:r.detections.malicious||0}),e.jsx("p",{className:"text-xs text-white/50",children:"Malicious"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-yellow-400",children:r.detections.suspicious||0}),e.jsx("p",{className:"text-xs text-white/50",children:"Suspicious"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-400",children:r.detections.clean||0}),e.jsx("p",{className:"text-xs text-white/50",children:"Clean"})]})]})]})]})]}),e.jsxs("div",{className:"p-6 border-t border-slate-700 flex justify-end gap-3",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 rounded-lg text-white/70 hover:text-white hover:bg-slate-700 transition-colors",children:"Close"}),t.status==="completed"&amp;&amp;e.jsxs("button",{onClick:()=&gt;{a(t),s()},className:"px-4 py-2 rounded-lg bg-brand-purple hover:bg-purple-700 text-white font-semibold transition-colors flex items-center gap-2",children:[e.jsx(le,{className:"w-5 h-5"}),"View Full Results"]})]})]})})]})}function os({currentStage:t}){const s=[{id:1,name:"Upload",icon:oe},{id:2,name:"Static",icon:L},{id:3,name:"Dynamic",icon:E},{id:4,name:"Network",icon:M},{id:5,name:"Report",icon:A}];return e.jsx("div",{className:"flex items-center justify-between px-4",children:s.map((a,r)=&gt;e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:`relative flex flex-col items-center ${a.id&lt;=t?"text-brand-purple":"text-slate-600"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center border-2 transition-all duration-500 ${a.id&lt;t?"bg-brand-purple border-brand-purple":a.id===t?"border-brand-purple bg-brand-purple/20 animate-pulse":"border-slate-600 bg-slate-800"}`,children:e.jsx(a.icon,{className:`w-5 h-5 ${a.id&lt;=t?"text-white":"text-slate-500"}`})}),e.jsx("span",{className:`text-xs mt-2 font-semibold ${a.id&lt;=t?"text-white":"text-slate-500"}`,children:a.name}),a.id===t&amp;&amp;e.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-green-400 rounded-full animate-ping"})]}),r&lt;s.length-1&amp;&amp;e.jsx("div",{className:`w-16 h-0.5 mx-2 transition-all duration-500 ${a.id&lt;t?"bg-brand-purple":"bg-slate-700"}`,children:a.id===t&amp;&amp;e.jsx("div",{className:"h-full bg-gradient-to-r from-brand-purple to-transparent animate-pulse",style:{width:"50%"}})})]},a.id))})}function zs(){var W,K,q,G,X,Z;const{isDarkMode:t}=ce(),[s,a]=i.useState(null),[r,l]=i.useState("submit"),[d,x]=i.useState(null),[f,c]=i.useState(0),[p,g]=i.useState(!1),[n,v]=i.useState(null),C=Ue(),{data:u,isLoading:_,refetch:w}=ae({queryKey:["sandbox-sessions"],queryFn:async()=&gt;{const h=localStorage.getItem("rodeo_token"),j={"Content-Type":"application/json"};h&amp;&amp;(j.Authorization=`Bearer ${h}`);const k=await fetch("/api/sandbox/sessions?limit=10",{headers:j});return k.ok?k.json():(console.warn("Failed to fetch sandbox sessions:",k.status),{sessions:[],total:0})},refetchInterval:h=&gt;{var T;return C?r==="progress"?3e3:(((T=h.state.data)==null?void 0:T.sessions)||[]).some(Q=&gt;Q.status==="running"||Q.status==="pending")?1e4:!1:!1},refetchOnWindowFocus:!1,refetchOnReconnect:!1,retry:!1,staleTime:1e4}),b=h=&gt;{a(h.session_id),l("progress"),c(1),[2,3,4,5].forEach((k,T)=&gt;{setTimeout(()=&gt;c(k),(T+1)*8e3)})},y=h=&gt;{fetch(`/api/sandbox/sessions/${h.session_id}/results`).then(j=&gt;j.json()).then(j=&gt;{const k=j.results||{};j.threat_intel&amp;&amp;(k.threat_intel=j.threat_intel,k.threat_level||(k.threat_level=j.threat_intel.threat_level)),x(k),l("results"),c(5)}).catch(j=&gt;console.error("Failed to fetch results:",j))},m=h=&gt;{v(h)},o=h=&gt;{a(h.session_id),h.status==="completed"?fetch(`/api/sandbox/sessions/${h.session_id}/results`).then(j=&gt;j.json()).then(j=&gt;{const k=j.results||{};j.threat_intel&amp;&amp;(k.threat_intel=j.threat_intel,k.threat_level||(k.threat_level=j.threat_intel.threat_level)),x(k),l("results")}):h.status==="running"&amp;&amp;l("progress")};i.useEffect(()=&gt;{const h=j=&gt;{j.key==="1"&amp;&amp;l("submit"),j.key==="2"&amp;&amp;s&amp;&amp;l("progress"),j.key==="3"&amp;&amp;d&amp;&amp;l("results"),j.key==="t"&amp;&amp;g(k=&gt;!k)};return window.addEventListener("keydown",h),()=&gt;window.removeEventListener("keydown",h)},[s,d]);const N=((W=u==null?void 0:u.sessions)==null?void 0:W.filter(h=&gt;h.status==="running").length)||0,S=((K=u==null?void 0:u.sessions)==null?void 0:K.filter(h=&gt;h.status==="completed").length)||0,$=((q=u==null?void 0:u.sessions)==null?void 0:q.filter(h=&gt;h.status==="failed").length)||0;return e.jsxs("div",{className:"space-y-6 pb-8",children:[e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx(ss,{}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-brand-purple/20 via-pink-500/10 to-blue-500/20 rounded-2xl blur-xl"}),e.jsxs("div",{className:"relative bg-slate-800/60 backdrop-blur-sm rounded-2xl border border-slate-700 p-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-brand-purple to-pink-500 rounded-2xl flex items-center justify-center",children:e.jsx(se,{className:"w-8 h-8 text-white"})}),e.jsx("div",{className:"absolute -inset-1 bg-gradient-to-br from-brand-purple to-pink-500 rounded-2xl blur opacity-50 animate-pulse-slow"})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-brand-purple via-pink-400 to-blue-400 bg-clip-text text-transparent",children:"R-O-D-E-O Sandbox"}),e.jsxs("p",{className:"text-white/70 mt-1 text-lg flex items-center space-x-2",children:[e.jsx(O,{className:"w-5 h-5 text-brand-purple"}),e.jsx("span",{children:"AI-Powered Malware Analysis"})]})]})]}),e.jsx("div",{className:"flex bg-slate-900/70 rounded-xl p-1.5 border border-slate-700 shadow-lg",children:[{id:"submit",label:"Submit",icon:oe},{id:"progress",label:"Progress",icon:E,disabled:!s},{id:"results",label:"Results",icon:L,disabled:!d}].map(h=&gt;e.jsxs("button",{onClick:()=&gt;l(h.id),disabled:h.disabled,className:`flex items-center space-x-2 px-5 py-2.5 rounded-lg text-sm font-semibold transition-all duration-300</span>
<span class="cstat-no" title="statement not covered" >                    ${r===h.id?"bg-gradient-to-r from-brand-purple to-pink-500 text-white shadow-lg shadow-brand-purple/30":"text-white/60 hover:text-white hover:bg-slate-800 disabled:opacity-30 disabled:cursor-not-allowed"}`,children:[e.jsx(h.icon,{className:"w-4 h-4"}),e.jsx("span",{children:h.label})]},h.id))})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-4 gap-4",children:[e.jsx(P,{icon:se,label:"Total Sessions",value:(u==null?void 0:u.total)||0,color:"brand-purple"}),e.jsx(P,{icon:V,label:"Running",value:N,color:"blue"}),e.jsx(P,{icon:A,label:"Completed",value:S,color:"green",trend:S&gt;0?12:void 0}),e.jsx(P,{icon:D,label:"Failed",value:$,color:"red"})]}),r==="progress"&amp;&amp;s&amp;&amp;e.jsx("div",{className:"mt-6 py-4 bg-slate-900/30 rounded-xl border border-slate-700/50",children:e.jsx(os,{currentStage:f})})]})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[e.jsxs("div",{className:"col-span-3 space-y-4",children:[e.jsxs("div",{className:"bg-slate-800/40 backdrop-blur-sm rounded-2xl border border-slate-700 p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-bold text-white flex items-center space-x-2",children:[e.jsx(Ce,{className:"w-5 h-5 text-brand-purple"}),e.jsx("span",{children:"Sessions"})]}),N&gt;0&amp;&amp;e.jsxs("span",{className:"flex items-center space-x-1 text-xs text-blue-400 bg-blue-500/10 px-2 py-1 rounded-full",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full animate-pulse"}),e.jsxs("span",{children:[N," active"]})]})]}),e.jsx("div",{className:"min-h-[280px]",children:_?e.jsx("div",{className:"space-y-3",children:[...Array(3)].map((h,j)=&gt;e.jsx("div",{className:"h-20 bg-slate-700/30 rounded-xl animate-pulse"},j))}):((G=u==null?void 0:u.sessions)==null?void 0:G.length)===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx(H,{className:"w-12 h-12 mx-auto mb-2 text-slate-600"}),e.jsx("p",{className:"text-white/50 text-sm",children:"No sessions yet"}),e.jsx("p",{className:"text-white/30 text-xs mt-1",children:"Submit a sample to get started"})]}):e.jsx("div",{className:"space-y-2 max-h-[280px] overflow-y-auto pr-1 scrollbar-thin scrollbar-thumb-slate-700",children:(X=u==null?void 0:u.sessions)==null?void 0:X.map(h=&gt;e.jsx(ns,{session:h,isActive:s===h.session_id,onClick:()=&gt;m(h)},h.session_id))})})]}),e.jsx(rs,{sessions:u==null?void 0:u.sessions}),e.jsxs("div",{className:"bg-slate-800/40 backdrop-blur-sm rounded-xl border border-slate-700 p-4",children:[e.jsx("p",{className:"text-xs font-semibold text-white/50 mb-2",children:"Keyboard Shortcuts"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[{key:"1",action:"Submit"},{key:"2",action:"Progress"},{key:"3",action:"Results"},{key:"T",action:"Terminal"}].map(h=&gt;e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("kbd",{className:"px-2 py-1 bg-slate-700 rounded text-white/70 font-mono",children:h.key}),e.jsx("span",{className:"text-white/50",children:h.action})]},h.key))})]})]}),e.jsxs("div",{className:"col-span-6",children:[r==="submit"&amp;&amp;e.jsxs("div",{className:"space-y-4",children:[e.jsx(He,{onSubmitSuccess:b}),e.jsxs("div",{className:"bg-slate-800/40 backdrop-blur-sm rounded-2xl border border-slate-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center space-x-2",children:[e.jsx(H,{className:"w-5 h-5 text-brand-purple"}),e.jsx("span",{children:"Sandbox Environment"})]}),e.jsx(ts,{isActive:r==="progress",threatLevel:d==null?void 0:d.threat_level})]})]}),r==="progress"&amp;&amp;s&amp;&amp;e.jsx(Ke,{sessionId:s,onComplete:y}),r==="results"&amp;&amp;d&amp;&amp;e.jsx(Xe,{sessionId:s,results:d}),r==="progress"&amp;&amp;!s&amp;&amp;e.jsxs("div",{className:"bg-slate-800/40 backdrop-blur-sm rounded-2xl border border-slate-700 p-12 text-center",children:[e.jsx(B,{className:"w-16 h-16 text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-white/70 text-lg",children:"No active analysis"}),e.jsx("p",{className:"text-white/50 text-sm mt-2",children:"Submit a sample to begin"})]}),r==="results"&amp;&amp;!d&amp;&amp;e.jsxs("div",{className:"bg-slate-800/40 backdrop-blur-sm rounded-2xl border border-slate-700 p-12 text-center",children:[e.jsx(L,{className:"w-16 h-16 text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-white/70 text-lg",children:"No results available"}),e.jsx("p",{className:"text-white/50 text-sm mt-2",children:"Complete an analysis to view results"})]})]}),e.jsxs("div",{className:"col-span-3 space-y-4",children:[(d==null?void 0:d.threat_level)&amp;&amp;e.jsxs("div",{className:"bg-slate-800/40 backdrop-blur-sm rounded-2xl border border-slate-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center space-x-2",children:[e.jsx(I,{className:"w-5 h-5 text-red-400"}),e.jsx("span",{children:"Threat Level"})]}),e.jsx(ls,{level:d.threat_level})]}),e.jsxs("div",{className:"bg-slate-800/40 backdrop-blur-sm rounded-2xl border border-slate-700 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-sm font-bold text-white flex items-center space-x-2",children:[e.jsx(_e,{className:"w-4 h-4 text-cyan-400"}),e.jsx("span",{children:"Terminal"})]}),e.jsx("button",{onClick:()=&gt;g(!p),className:"text-xs text-white/50 hover:text-white",children:p?"Hide":"Show"})]}),p&amp;&amp;e.jsx(as,{isActive:r==="progress"}),!p&amp;&amp;e.jsxs("p",{className:"text-xs text-white/40 text-center py-4",children:["Press ",e.jsx("kbd",{className:"px-1 bg-slate-700 rounded",children:"T"})," to toggle terminal"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-brand-purple/20 to-pink-500/20 rounded-2xl border border-brand-purple/30 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Quick Stats"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-white/70 text-sm",children:"Avg. Analysis Time"}),e.jsx("span",{className:"text-white font-semibold",children:"35s"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-white/70 text-sm",children:"Threats Detected"}),e.jsx("span",{className:"text-red-400 font-semibold",children:((Z=u==null?void 0:u.sessions)==null?void 0:Z.filter(h=&gt;h.threat_level==="critical"||h.threat_level==="high").length)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-white/70 text-sm",children:"Success Rate"}),e.jsx("span",{className:"text-green-400 font-semibold",children:(u==null?void 0:u.total)&gt;0?`${Math.round(S/u.total*100)}%`:"0%"})]})]})]})]})]}),e.jsx("div",{className:"grid grid-cols-4 gap-4",children:[{icon:ie,title:"Fast Analysis",desc:"Results in under 40 seconds",color:"from-orange-500/20 to-red-500/20",border:"border-orange-500/30",iconColor:"text-orange-400"},{icon:E,title:"AI-Powered",desc:"ML-based threat detection",color:"from-blue-500/20 to-cyan-500/20",border:"border-blue-500/30",iconColor:"text-blue-400"},{icon:M,title:"Network Analysis",desc:"Full traffic capture &amp; inspection",color:"from-purple-500/20 to-pink-500/20",border:"border-purple-500/30",iconColor:"text-purple-400"},{icon:le,title:"Real-Time",desc:"Live monitoring &amp; alerts",color:"from-green-500/20 to-emerald-500/20",border:"border-green-500/30",iconColor:"text-green-400"}].map((h,j)=&gt;e.jsxs("div",{className:`bg-gradient-to-br ${h.color} rounded-xl border ${h.border} p-5</span>
<span class="cstat-no" title="statement not covered" >              hover:scale-[1.02] transition-transform cursor-default group`,children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx(h.icon,{className:`w-6 h-6 ${h.iconColor} group-hover:scale-110 transition-transform`}),e.jsx("h3",{className:"text-white font-bold",children:h.title})]}),e.jsx("p",{className:"text-white/60 text-sm",children:h.desc})]},j))}),n&amp;&amp;e.jsx(is,{session:n,onClose:()=&gt;v(null),onViewResults:o})]})}export{zs as default};</span>
&nbsp;</pre></td></tr></table></pre>

                <div class='push'></div><!-- for sticky footer -->
            </div><!-- /wrapper -->
            <div class='footer quiet pad2 space-top1 center small'>
                Code coverage generated by
                <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
                at 2026-02-09T23:34:34.128Z
            </div>
        <script src="../../prettify.js"></script>
        <script>
            window.onload = function () {
                prettyPrint();
            };
        </script>
        <script src="../../sorter.js"></script>
        <script src="../../block-navigation.js"></script>
    </body>
</html>
    